#!/usr/bin/env zsh
# shellcheck disable=all

zmodload zsh/zutil
zmodload zsh/complist
zmodload zsh/parameter
zmodload zsh/terminfo 2>/dev/null

setopt MULTIOS              # Allow multiple redirections (e.g., > file1 > file2)
setopt CLOBBER              # Allow > to overwrite existing files (default)
setopt COMBINING_CHARS      # Handle Unicode combining characters correctly
setopt INTERACTIVE_COMMENTS # Allow comments starting with # in interactive shells
setopt NO_BEEP              # Disable audible bell on errors
setopt NO_MAIL_WARNING      # Disable "you have mail" notifications

setopt HASH_LIST_ALL         # Hash command locations on first use for speed
setopt PATH_SCRIPT           # Search PATH for scripts even if not marked executable
setopt PROMPT_SUBST          # Allow parameter expansion and command substitution in prompts
setopt SHORT_LOOPS           # Allow shorter loop syntax (e.g., for i ({1..3}) ...)
setopt NO_WARN_CREATE_GLOBAL # Suppress warnings when creating global variables

HISTFILE="${HOME}/.zsh_history"
HISTSIZE=1000000
SAVEHIST=1000000

setopt SHARE_HISTORY          # Share history instantly across all running shells
setopt EXTENDED_HISTORY       # Save timestamp and duration for each command
setopt HIST_VERIFY            # Show command before executing from history expansion
setopt HIST_FCNTL_LOCK        # Use fcntl locking for better history file concurrency
setopt HIST_LEX_WORDS         # Treat complex commands as single history entries
setopt HIST_REDUCE_BLANKS     # Remove superfluous blanks from history entries
setopt HIST_IGNORE_SPACE      # Ignore commands starting with a space
setopt HIST_FIND_NO_DUPS      # Don't show duplicate consecutive commands when searching
setopt HIST_EXPIRE_DUPS_FIRST # Remove older duplicates first when trimming history
setopt HIST_IGNORE_ALL_DUPS   # Never store duplicate commands
setopt HIST_SAVE_NO_DUPS      # Don't write duplicate consecutive commands to the history file

setopt AUTO_PUSHD        # Automatically pushd when changing directories with cd
setopt PUSHD_TO_HOME     # `pushd` without arguments goes to $HOME
setopt PUSHD_MINUS       # Allow `cd -N` to navigate back N directories in the stack
setopt PUSHD_SILENT      # Suppress printing the directory stack after pushd/popd
setopt PUSHD_IGNORE_DUPS # Don't push duplicate directories onto the stack
setopt NO_AUTO_CD        # Disable implicit cd when typing a directory name

autoload -Uz compinit
compinit

zstyle ':completion:*' use-cache on
zstyle ':completion:*' menu select
zstyle ':completion:*' matcher-list 'm:{a-zA-Z}={A-Za-z}'

setopt ALWAYS_TO_END     # Move cursor to the end of the completed word
setopt AUTO_LIST         # Automatically list choices on ambiguous completion
setopt AUTO_MENU         # Show completion menu after second consecutive tab press
setopt AUTO_PARAM_SLASH  # Add a trailing slash to completed directory names
setopt COMPLETE_ALIASES  # Complete aliases as full commands
setopt COMPLETE_IN_WORD  # Allow completion from within a word
setopt LIST_PACKED       # Display completion list compactly
setopt MAGIC_EQUAL_SUBST # Perform filename expansion after '=' (e.g., `make file=`)
setopt NO_CORRECT        # Disable auto-correction of commands
setopt NO_CORRECT_ALL    # Disable auto-correction of arguments
setopt NO_LIST_BEEP      # Disable beep on ambiguous completion

setopt EXTENDED_GLOB   # Enable extended globbing features (like `^` for negation)
setopt RC_EXPAND_PARAM # Expand array parameters in substitutions (e.g., ${array[@]})
setopt NO_CASE_GLOB    # Case-sensitive globbing (pathname expansion)
setopt NO_CASE_MATCH   # Case-sensitive pattern matching
setopt NO_NOMATCH      # If a pattern has no match, leave it unchanged (don't error)

setopt AUTO_RESUME    # Attempt to resume existing jobs matching the command typed
setopt CHECK_JOBS     # Report status of background jobs before exiting the shell
setopt LONG_LIST_JOBS # Display detailed job information for the `jobs` command
setopt NOTIFY         # Report status of background jobs immediately upon completion
setopt NO_BG_NICE     # Don't run background jobs at a lower priority
setopt NO_HUP         # Don't send HUP signal to background jobs on shell exit

bindkey -e
KEYTIMEOUT=1

source "${HOME}/.zsh/01-path.zsh"
source "${HOME}/.zsh/02-env.zsh"
source "${HOME}/.zsh/03-aliases.zsh"
